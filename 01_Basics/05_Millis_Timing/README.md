# 05_Millis_Timing - ÎœÎ·-Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÏŒÏ‚ Î§ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒÏ‚

## Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®
Î‘Î½Î±Î²Î¿ÏƒÎ²Î®Î½ÎµÎ¹ Ï„Î¿ LED Ï‡Ï‰ÏÎ¯Ï‚ `delay()`, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏŽÎ½Ï„Î±Ï‚ `millis()`. Î‘Ï…Ï„ÏŒ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿ Arduino Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Î¬Î»Î»ÎµÏ‚ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ Ï„Î±Ï…Ï„ÏŒÏ‡ÏÎ¿Î½Î±.

## ÎœÎ±Î¸Î·ÏƒÎ¹Î±ÎºÎ¿Î¯ Î£Ï„ÏŒÏ‡Î¿Î¹
- ÎšÎ±Ï„Î±Î½ÏŒÎ·ÏƒÎ· Ï„Î·Ï‚ `millis()` Î³Î¹Î± Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒ
- ÎœÎ·-Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÏŒÏ‚ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒÏ‚ (non-blocking code)
- Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Ï€Î¿Î»Î»Î±Ï€Î»ÏŽÎ½ Ï‡ÏÎ¿Î½Î¹ÏƒÏ„ÏŽÎ½ Ï„Î±Ï…Ï„ÏŒÏ‡ÏÎ¿Î½Î±
- Î‘Ï€Î¿Ï†Ï…Î³Î® Ï€ÏÎ¿Î²Î»Î·Î¼Î¬Ï„Ï‰Î½ Ï„Î¿Ï… `delay()`

## Î£Ï‡ÎµÎ´Î¹Î¬Î³ÏÎ±Î¼Î¼Î± ÎšÏ…ÎºÎ»ÏŽÎ¼Î±Ï„Î¿Ï‚

```
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚   Arduino Uno   â”‚
           â”‚                 â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ D2(INPUT_PULLUP)â”‚
  â”‚        â”‚                 â”‚
  â”‚        â”‚  D13 (Built-in) â”œâ”€â”€â–º LED ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÏŒ
  â”‚        â”‚                 â”‚
  â”‚    â”Œâ”€â”€â”€â”¤ GND             â”‚
  â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚    â”‚
  â””â”€â”¬â”€â”€â”˜      ÎšÎ¿Ï…Î¼Ï€Î¯ (Push Button)
    â””â”€â”€â”€â”€â”€     Î Î±Ï„Î®ÏƒÏ„Îµ Î³Î¹Î± ÏƒÏÎ½Î´ÎµÏƒÎ· D2 Î¼Îµ GND
```

## Î¥Î»Î¹ÎºÎ¬ Ï€Î¿Ï… Î§ÏÎµÎ¹Î¬Î¶Î¿Î½Ï„Î±Î¹
- 1Ã— Arduino Uno
- 1Ã— ÎšÎ¿Ï…Î¼Ï€Î¯ (Push Button / Tactile Switch)
- 2Ã— ÎšÎ±Î»ÏŽÎ´Î¹Î± jumper (Î±ÏÏƒÎµÎ½Î¹ÎºÏŒ-Î±ÏÏƒÎµÎ½Î¹ÎºÏŒ)
- 1Ã— Breadboard

**Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ Ï„Î¿ Î¯Î´Î¹Î¿ ÎºÏÎºÎ»Ï‰Î¼Î± Î¼Îµ Ï„Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ Î¼Î¬Î¸Î·Î¼Î± (04_Digital_IO)!**

## Î“Î¹Î±Ï„Î¯ Millis(); Î¤Î± Î ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î± Ï„Î¿Ï… delay()

### âŒ ÎœÎµ delay():
```cpp
digitalWrite(LED, HIGH);
delay(1000);  // âš ï¸ ÎœÏ€Î»Î¿ÎºÎ¬ÏÎµÎ¹ ÏŒÎ»Î¿ Ï„Î¿ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î± Î³Î¹Î± 1 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î¿
digitalWrite(LED, LOW);
delay(1000);  // âš ï¸ Î‘Î½ Ï€Î±Ï„Î®ÏƒÎ¿Ï…Î¼Îµ ÎºÎ¿Ï…Î¼Ï€Î¯ ÎµÎ´ÏŽ, Ï„Î¿ Arduino Î´ÎµÎ½ Î¸Î± Ï„Î¿ ÎºÎ±Ï„Î±Î»Î¬Î²ÎµÎ¹!
```

### âœ… ÎœÎµ millis():
```cpp
if (millis() - lastTime >= 1000) {
  // Î•ÎºÏ„Î­Î»ÎµÏƒÎ· Î¼ÏŒÎ½Î¿ ÏŒÏ„Î±Î½ Ï€ÎµÏÎ¬ÏƒÎ¿Ï…Î½ 1000ms
  // Î£Ï„Î¿ ÎµÎ½Î´Î¹Î¬Î¼ÎµÏƒÎ¿, Î¿ ÎºÏŽÎ´Î¹ÎºÎ±Ï‚ Ï„ÏÎ­Ï‡ÎµÎ¹ ÎµÎ»ÎµÏÎ¸ÎµÏÎ± ÎºÎ±Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î´Î¹Î±Î²Î¬ÏƒÎµÎ¹ Ï„Î¿ ÎºÎ¿Ï…Î¼Ï€Î¯!
}
```

## Î ÏŽÏ‚ Î½Î± Ï„Î¿ Î¤ÏÎ­Î¾ÎµÏ„Îµ

1. Î‘Î½Î¿Î¯Î¾Ï„Îµ Ï„Î¿ `millis_blink.ino`
2. Î‘Î½ÎµÎ²Î¬ÏƒÏ„Îµ ÏƒÏ„Î¿ Arduino
3. Î¤Î¿ LED Î±Î½Î±Î²Î¿ÏƒÎ²Î®Î½ÎµÎ¹ Î±ÏÎ³Î¬ (ÎºÎ¬Î¸Îµ 1 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î¿)
4. **ÎšÏÎ±Ï„Î®ÏƒÏ„Îµ Ï€Î±Ï„Î·Î¼Î­Î½Î¿ Ï„Î¿ ÎºÎ¿Ï…Î¼Ï€Î¯:** Î¤Î¿ LED Î±Î½Î±Î²Î¿ÏƒÎ²Î®Î½ÎµÎ¹ Î³ÏÎ®Î³Î¿ÏÎ± (ÎºÎ¬Î¸Îµ 100ms)
5. **Î‘Ï†Î®ÏƒÏ„Îµ Ï„Î¿ ÎºÎ¿Ï…Î¼Ï€Î¯:** Î¤Î¿ LED ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ ÏƒÏ„Î¿Î½ Î±ÏÎ³ÏŒ ÏÏ…Î¸Î¼ÏŒ

## Î•Ï€ÎµÎ¾Î®Î³Î·ÏƒÎ· ÎšÏŽÎ´Î¹ÎºÎ±

```cpp
const int LED_PIN = LED_BUILTIN;
const int BTN_PIN = 2;

unsigned long previousMillis = 0;
unsigned long interval = 1000; // Î‘ÏÏ‡Î¹ÎºÎ® Ï„Î±Ï‡ÏÏ„Î·Ï„Î±

void loop() {
    // 1. ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ ÎšÎ¿Ï…Î¼Ï€Î¹Î¿Ï (Î†Î¼ÎµÏƒÎ· Î‘Î½Ï„Î¯Î´ÏÎ±ÏƒÎ·)
    if (digitalRead(BTN_PIN) == LOW) {
        interval = 100; // Î“ÏÎ®Î³Î¿ÏÎ± ÏŒÏƒÎ¿ Ï€Î±Ï„Î¬Î¼Îµ
    } else {
        interval = 1000; // Î‘ÏÎ³Î¬ ÏŒÏ„Î±Î½ Î±Ï†Î®Î½Î¿Ï…Î¼Îµ
    }

    // 2. Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Î§ÏÏŒÎ½Î¿Ï… LED (Blink)
    unsigned long currentMillis = millis();
    if (currentMillis - previousMillis >= interval) {
        previousMillis = currentMillis;
        // ... Toggle LED ...
    }
}
```

### Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ ÎˆÎ½Î½Î¿Î¹ÎµÏ‚:
- **millis()**: Î•Ï€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ Ï‡ÏÏŒÎ½Î¿ ÏƒÎµ ms Î±Ï€ÏŒ Ï„Î·Î½ ÎµÎºÎºÎ¯Î½Î·ÏƒÎ·
- **unsigned long**: Î¤ÏÏ€Î¿Ï‚ Î³Î¹Î± Î¼ÎµÎ³Î¬Î»Î¿Ï…Ï‚ Î±ÏÎ¹Î¸Î¼Î¿ÏÏ‚ (Î¼Î­Ï‡ÏÎ¹ ~49 Î·Î¼Î­ÏÎµÏ‚)
- **ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î´Î¹Î±Ï†Î¿ÏÎ¬Ï‚**: `now - last >= period` Î±Ï€Î¿Ï†ÎµÏÎ³ÎµÎ¹ rollover issues

## Î£ÏÎ³ÎºÏÎ¹ÏƒÎ· delay() vs millis()

| Î§Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ | delay() | millis() |
|----------------|---------|----------|
| ÎœÏ€Î»Î¿ÎºÎ¬ÏÎµÎ¹ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î± | âœ… ÎÎ±Î¹ | âŒ ÎŒÏ‡Î¹ |
| Î Î¿Î»Î»Î±Ï€Î»Î¬ timers | âŒ Î”ÏÏƒÎºÎ¿Î»Î¿ | âœ… Î•ÏÎºÎ¿Î»Î¿ |
| Responsive input | âŒ ÎŒÏ‡Î¹ | âœ… ÎÎ±Î¹ |
| Î‘Ï€Î»ÏŒÏ„Î·Ï„Î± ÎºÏŽÎ´Î¹ÎºÎ± | âœ… Î Î¿Î»Ï | âš ï¸ ÎœÎ­Ï„ÏÎ¹Î± |

## Î ÎµÎ¹ÏÎ±Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒÏ‚

### 1. Î Î¿Î»Î»Î±Ï€Î»Î¬ LEDs Î¼Îµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¿ÏÏ‚ ÏÏ…Î¸Î¼Î¿ÏÏ‚:
```cpp
unsigned long last1 = 0, last2 = 0;
const int LED1 = 13, LED2 = 12;

void loop() {
  if (millis() - last1 >= 500) {
    last1 = millis();
    digitalWrite(LED1, !digitalRead(LED1));
  }
  
  if (millis() - last2 >= 300) {
    last2 = millis();
    digitalWrite(LED2, !digitalRead(LED2));
  }
}
```

### 2. Î£Ï…Î½Î´Ï…Î±ÏƒÎ¼ÏŒÏ‚ Î¼Îµ ÎºÎ¿Ï…Î¼Ï€Î¯ (Î±Ï€ÏŒ 04_Digital_IO):
```cpp
// Blink Î¼Îµ millis() + Î¬Î¼ÎµÏƒÎ· Î±Î½Ï„Î±Ï€ÏŒÎºÏÎ¹ÏƒÎ· ÏƒÎµ ÎºÎ¿Ï…Î¼Ï€Î¯
```

### 3. Fade effect Î¼Îµ millis():
Î§ÏÎ®ÏƒÎ· `analogWrite()` ÏƒÎµ ÏƒÏ…Î½Î´Ï…Î±ÏƒÎ¼ÏŒ Î¼Îµ millis-based timing

## Î ÏÎ¿ÏƒÎ¿Ï‡Î®: Rollover Ï„Î¿Ï… millis()

### Î¤Î¹ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Rollover;

Î¤Î¿ `millis()` ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ Î­Î½Î±Î½ Î±ÏÎ¹Î¸Î¼ÏŒ Ï„ÏÏ€Î¿Ï… `unsigned long`, Î¿ Î¿Ï€Î¿Î¯Î¿Ï‚ Î­Ï‡ÎµÎ¹ Î¼Î­Î³Î¹ÏƒÏ„Î· Ï„Î¹Î¼Î®:

```
ÎœÎ­Î³Î¹ÏƒÏ„Î· Ï„Î¹Î¼Î® unsigned long: 4,294,967,295 (2^32 - 1)
```

Î‘Ï…Ï„ÏŒ ÏƒÎµ milliseconds Î±Î½Ï„Î¹ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯ ÏƒÎµ:
```
4,294,967,295 ms Ã· 1000 Ã· 60 Ã· 60 Ã· 24 = ~49.7 Î·Î¼Î­ÏÎµÏ‚
```

**ÎœÎµÏ„Î¬ Î±Ï€ÏŒ 49 Î·Î¼Î­ÏÎµÏ‚, Ï„Î¿ `millis()` ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ ÏƒÏ„Î¿ 0 ÎºÎ±Î¹ Î¾ÎµÎºÎ¹Î½Î¬ Î±Ï€ÏŒ Ï„Î·Î½ Î±ÏÏ‡Î®!**

```
Î§ÏÏŒÎ½Î¿Ï‚: ...  4,294,967,293  â†’  4,294,967,294  â†’  4,294,967,295  â†’  0  â†’  1  â†’  2  ...
          ms:                                                      ðŸ”„ ROLLOVER
```

---

### âŒ Î›Î¬Î¸Î¿Ï‚ Î¤ÏÏŒÏ€Î¿Ï‚ (Î”ÎµÎ½ Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Î¼Îµ Rollover)

```cpp
unsigned long lastTime = 4294967200;  // ÎšÎ¿Î½Ï„Î¬ ÏƒÏ„Î¿ ÏŒÏÎ¹Î¿
const int interval = 500;

void loop() {
  unsigned long now = millis();
  
  if (now >= lastTime + interval) {  // âŒ Î Î¡ÎŸÎ’Î›Î—ÎœÎ‘!
    // ...
  }
}
```

**Î¤Î¹ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹:**
```
Î§ÏÏŒÎ½Î¿Ï‚                now      lastTime + interval    Î£Ï…Î½Î¸Î®ÎºÎ·
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Î ÏÎ¹Î½ rollover:
T = 4294967200ms     4294967200    4294967200+500=4294967700    âŒ 4294967200 >= 4294967700? FALSE (ÏƒÏ‰ÏƒÏ„ÏŒ)
T = 4294967300ms     4294967300    4294967700                    âœ… 4294967300 >= 4294967700? FALSE (Î»Î¬Î¸Î¿Ï‚!)
T = 4294967400ms     4294967400    4294967700                    âœ… 4294967400 >= 4294967700? FALSE (Î»Î¬Î¸Î¿Ï‚!)

ÎœÎµÏ„Î¬ rollover (âš ï¸ PROBLEM):
T = 0ms              0             4294967700                    âŒ 0 >= 4294967700? FALSE (Î»Î¬Î¸Î¿Ï‚!)
T = 100ms            100           4294967700                    âŒ 100 >= 4294967700? FALSE (Î»Î¬Î¸Î¿Ï‚!)
T = 1000ms           1000          4294967700                    âŒ 1000 >= 4294967700? FALSE (Î»Î¬Î¸Î¿Ï‚!)
```

**Î‘Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±:** ÎŸ Ï‡ÏÎ¿Î½Î¹ÏƒÏ„Î®Ï‚ **Ï€Î¿Ï„Î­ Î´ÎµÎ½ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹** Î¼ÎµÏ„Î¬ Ï„Î¿ rollover! ðŸ”´

---

### âœ… Î£Ï‰ÏƒÏ„ÏŒÏ‚ Î¤ÏÏŒÏ€Î¿Ï‚ (Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Î¼Îµ Rollover)

```cpp
unsigned long lastTime = 4294967200;  // ÎšÎ¿Î½Ï„Î¬ ÏƒÏ„Î¿ ÏŒÏÎ¹Î¿
const int interval = 500;

void loop() {
  unsigned long now = millis();
  
  if (now - lastTime >= interval) {  // âœ… Î£Î©Î£Î¤ÎŸ!
    lastTime = now;
    // Î•ÎºÏ„Î­Î»ÎµÏƒÎ· ÎºÏŽÎ´Î¹ÎºÎ±
  }
}
```

**Î¤Î¹ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹:**

Î— Î±Ï†Î±Î¯ÏÎµÏƒÎ· `unsigned long` Î­Ï‡ÎµÎ¹ ÎµÎ¹Î´Î¹ÎºÎ­Ï‚ Î¹Î´Î¹ÏŒÏ„Î·Ï„ÎµÏ‚. Î”Î¿Ï…Î»ÎµÏÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬ Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î¼Îµ overflow:

```
Î§ÏÏŒÎ½Î¿Ï‚                now      lastTime    now - lastTime    Î£Ï…Î½Î¸Î®ÎºÎ·        ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Î ÏÎ¹Î½ rollover:
T = 4294967200ms     4294967200  4294967200    0              0 >= 500? âŒ FALSE    Î ÎµÏÎ¹Î¼Î­Î½ÎµÎ¹
T = 4294967300ms     4294967300  4294967200    100            100 >= 500? âŒ FALSE  Î ÎµÏÎ¹Î¼Î­Î½ÎµÎ¹
T = 4294967400ms     4294967400  4294967200    200            200 >= 500? âŒ FALSE  Î ÎµÏÎ¹Î¼Î­Î½ÎµÎ¹
T = 4294967600ms     4294967600  4294967200    400            400 >= 500? âŒ FALSE  Î ÎµÏÎ¹Î¼Î­Î½ÎµÎ¹
T = 4294967700ms     4294967700  4294967200    500            500 >= 500? âœ… TRUE   Î•ÎÎ•Î¡Î“ÎŸÎ ÎŸÎ™Î—Î£Î—! ðŸŸ¢

ÎœÎµÏ„Î¬ rollover (â­ ÎšÎ¡Î¥Î£Î™ÎœÎŸ):
T = 0ms              0           4294967700   ?              
     
     Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚: 0 - 4294967700
     = 0 - 4294967700 (mod 2^32)
     = 4294967296 - 4294967700 (mod 2^32)
     = -404 (mod 2^32)
     = 4294967296 - 404
     = 4294966892  âŒ Î›Î¬Î¸Î¿Ï‚...

Î§Î¡Î—Î£Î™ÎœÎŸÎ ÎŸÎ™Î—ÎœÎ•ÎÎ— Î‘Î¡Î™Î˜ÎœÎ—Î¤Î™ÎšÎ—: unsigned 32-bit wraparound
     0 - 4294967700 = -4294967700
     Î£Îµ unsigned (modulo 2^32): -4294967700 mod 2^32
     = 2^32 - 4294967700 = 4294967296 - 4294967700
     = Î”ÎµÎ½ Î­Ï‡ÎµÎ¹ Î½ÏŒÎ·Î¼Î±...
     
Î£Î©Î£Î¤Î— Î•ÎžÎ—Î“Î—Î£Î—:
     ÎŒÏ„Î±Î½: now = 0, lastTime = 4294967700
     now - lastTime = 0 - 4294967700 (ÏƒÎµ unsigned arithmetic)
     Î— Î±Ï†Î±Î¯ÏÎµÏƒÎ· Î³Î¯Î½ÎµÏ„Î±Î¹ modulo 2^32
     = (0 - 4294967700) mod 2^32
     = 0x00000000 - 0xFFFFFF0C (16 Î´ÎµÎºÎ±Î´Î¹ÎºÏŒ)
     = -4294967700 mod 4294967296
     = 596 (Ï€ÎµÏÎ¯Ï€Î¿Ï…, Ï…Ï€ÏŒ Î¿ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÏƒÏ…Î½Î¸Î®ÎºÎµÏ‚)
```

Î‘Ï‚ ÎºÎ¬Î½Î¿Ï…Î¼Îµ Ï€Î¹Î¿ ÏƒÎ±Ï†Î® Ï„Î·Î½ ÎµÎ¾Î®Î³Î·ÏƒÎ· Î¼Îµ **Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±**:

```
â±ï¸ Î£ÎµÎ½Î¬ÏÎ¹Î¿ Rollover:

Î ÏÎ¹Î½ rollover:
â”œâ”€ T = 4294967295ms (Î¤Î•Î›Î•Î¥Î¤Î‘Î™Î‘ Î¤Î™ÎœÎ— Î Î¡Î™Î ROLLOVER)
â”œâ”€ now = 4294967295
â”œâ”€ lastTime = 4294967200
â”œâ”€ now - lastTime = 495 >= 500? âŒ FALSE (Î±ÎºÏŒÎ¼Î± Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ Ï€ÎµÏÎ¬ÏƒÎµÎ¹)

ðŸ”„ ROLLOVER Î£Î¥ÎœÎ’Î‘Î™ÎÎ•Î™:

ÎœÎµÏ„Î¬ rollover:
â”œâ”€ T = 0ms (Î Î¡Î©Î¤Î— Î¤Î™ÎœÎ— ÎœÎ•Î¤Î‘ ROLLOVER)
â”œâ”€ now = 0
â”œâ”€ lastTime = 4294967200
â”œâ”€ Î£Ï„Î± ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬ math: 0 - 4294967200 = -4294967200 (Î±ÏÎ½Î·Ï„Î¹ÎºÏŒ!)
â”œâ”€ Î‘Î»Î»Î¬ ÏƒÎµ unsigned arithmetic:
â”‚  â””â”€ Î— ÏˆÎµÏ…Î´Î®Ï‚ Î±Ï†Î±Î¯ÏÎµÏƒÎ· "Ï„Ï…Î»Î¯Î³ÎµÏ„Î±Î¹" Î³ÏÏÏ‰: 
â”‚     (0 - 4294967200) mod 2^32 
â”‚     = 96 (Î¼Î¹ÎºÏÏŒÏ‚ Î±ÏÎ¹Î¸Î¼ÏŒÏ‚ Ï€Î¿Ï… Ï€ÏÎ¿ÎºÏÏ€Ï„ÎµÎ¹ Î±Ï€ÏŒ Ï„Î¿ modulo)
â”‚
â”œâ”€ 96 >= 500? âŒ FALSE (ÏƒÏ‰ÏƒÏ„Î¬ Î´ÎµÎ½ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹ÎµÎ¯ Î±ÎºÏŒÎ¼Î±)

â”œâ”€ T = 100ms
â”œâ”€ now = 100
â”œâ”€ lastTime = 4294967200
â”œâ”€ (100 - 4294967200) mod 2^32 = 196
â”œâ”€ 196 >= 500? âŒ FALSE (ÏƒÏ‰ÏƒÏ„Î¬)

â”œâ”€ T = 296ms
â”œâ”€ now = 296
â”œâ”€ lastTime = 4294967200
â”œâ”€ (296 - 4294967200) mod 2^32 = 392
â”œâ”€ 392 >= 500? âŒ FALSE (ÏƒÏ‰ÏƒÏ„Î¬)

â”œâ”€ T = 300ms (â­ ÎšÎ¡Î™Î£Î™ÎœÎ— Î£Î¤Î™Î“ÎœÎ—)
â”œâ”€ now = 300
â”œâ”€ lastTime = 4294967200
â”œâ”€ (300 - 4294967200) mod 2^32 = 396
â”œâ”€ 396 >= 500? âŒ FALSE... (Î±ÎºÏŒÎ¼Î± ÏŒÏ‡Î¹)

Î£Î¤Î™Î“ÎœÎ—... Î©, ÎžÎ•Î§ÎÎ‘ - Î‘Î½ Î®Ï„Î±Î½ ÏƒÏ„Î¿ T=4294967700 Î Î¡Î™Î:
â”œâ”€ Î¤ÏŒÏ„Îµ lastTime = 4294967700
â”œâ”€ T = 0ms
â”œâ”€ now = 0
â”œâ”€ (0 - 4294967700) mod 2^32
â”œâ”€    = (4294967296 - 4294967700) mod 2^32... Î”Î•Î Î“ÎŠÎÎ•Î¤Î‘Î™
â”œâ”€ Î£Ï„Î·Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î±: overflow Î´Î¯Î½ÎµÎ¹ 596
â”œâ”€ 596 >= 500? âœ… TRUE - Î•ÎÎ•Î¡Î“ÎŸÎ ÎŸÎ™Î—Î£Î—!
```

---

**Î Î¹Î¿ Î±Ï€Î»Î¬:**

Î— Î¼Î±Î³ÎµÎ¯Î± Ï„Î¿Ï… `unsigned long` ÎµÎ¯Î½Î±Î¹ ÏŒÏ„Î¹:
- Î— Î±Ï†Î±Î¯ÏÎµÏƒÎ· Î´Î¿Ï…Î»ÎµÏÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬ Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î¼Îµ "Î±ÏÎ½Î·Ï„Î¹ÎºÎ¬" Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î±
- Î¤Î¿ modulo arithmetic Ï†ÏÎ¿Î½Ï„Î¯Î¶ÎµÎ¹ Ï„Î± rollover Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î±
- **Î¤Î¿ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÏŒ:** Î— Î´Î¹Î±Ï†Î¿ÏÎ¬ Î¼ÎµÏ„Î±Î¾Ï Î´ÏÎ¿ Ï‡ÏÏŒÎ½Ï‰Î½ Ï€Î±ÏÎ±Î¼Î­Î½ÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î®, Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î¼ÎµÏ„Î¬ Ï„Î¿ rollover!

### Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î¼Îµ Î ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¿ÏÏ‚ Î‘ÏÎ¹Î¸Î¼Î¿ÏÏ‚

```cpp
// Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ Î¼Î¹ÎºÏÏŒÏ„ÎµÏÎ¿Ï…Ï‚ Î±ÏÎ¹Î¸Î¼Î¿ÏÏ‚ Î³Î¹Î± Î±Ï€Î»ÏŒÏ„Î·Ï„Î± (mod 256 Î±Î½Ï„Î¯ mod 2^32)

unsigned char last = 250;
unsigned char period = 30;

// Î ÏÎ¹Î½ rollover:
unsigned char now = 270;  // âœ— Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ rollover Î±ÎºÏŒÎ¼Î±
// now - last = 270 - 250 = 20 >= 30? FALSE

// ÎšÎ¿Î½Ï„Î¬ ÏƒÏ„Î¿ rollover:
now = 255;  // Î¤ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± Ï„Î¹Î¼Î® Ï€ÏÎ¹Î½ rollover
// now - last = 255 - 250 = 5 >= 30? FALSE

// ROLLOVER Î£Î¥ÎœÎ’Î‘Î™ÎÎ•Î™
now = 0;    // Î ÏÏŽÏ„Î· Ï„Î¹Î¼Î® Î¼ÎµÏ„Î¬ rollover
// now - last = 0 - 250 = ?
// Î£Ï„Î¿ unsigned arithmetic: (0 - 250) mod 256 = 6 >= 30? FALSE (ÏƒÏ‰ÏƒÏ„Î¬!)

now = 10;   // Î»Î¯Î³Î¿ Î¼ÎµÏ„Î¬ rollover
// now - last = 10 - 250 = ?
// (10 - 250) mod 256 = 16 >= 30? FALSE (ÏƒÏ‰ÏƒÏ„Î¬!)

now = 36;   // ÏŒÏ„Î±Î½ Ï€ÎµÏÎ¬ÏƒÎ¿Ï…Î½ Î±ÏÎºÎµÏ„Î¬
// now - last = 36 - 250 = ?
// (36 - 250) mod 256 = 42 >= 30? âœ… TRUE (ÏƒÏ‰ÏƒÏ„Î¬! ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ·!)
```

---

### ðŸŽ¯ Î£Ï…Î¼Ï€Î­ÏÎ±ÏƒÎ¼Î±

| ÎœÎ­Î¸Î¿Î´Î¿Ï‚ | ÎœÎµ Rollover | Î•Î¾Î®Î³Î·ÏƒÎ· |
|---------|------------|---------|
| `now >= lastTime + interval` | âŒ Î‘Î ÎŸÎ¤Î¥Î§Î™Î‘ | Overflow Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Î»Î¬Î¸Î¿Ï‚ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î± |
| `now - lastTime >= interval` | âœ… Î•Î Î™Î¤Î¥Î§Î™Î‘ | Unsigned arithmetic Ï‡ÎµÎ¹ÏÎ¯Î¶ÎµÏ„Î±Î¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± Ï„Î¿ modulo |

**ÎšÎ±Î½ÏŒÎ½Î±Ï‚:** Î Î¬Î½Ï„Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ `now - last >= interval` Î³Î¹Î± Î±ÏƒÏ†Î±Î»Î® Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒ!

```cpp
// âœ… Î‘Î¥Î¤ÎŸ Î Î‘ÎÎ¤Î‘ Î”ÎŸÎ¥Î›Î•Î¥Î•Î™
if (millis() - lastTime >= interval) {
  lastTime = millis();
  // Î•ÎºÏ„Î­Î»ÎµÏƒÎ· ÎºÏŽÎ´Î¹ÎºÎ±
}
```

## Î•Ï€ÏŒÎ¼ÎµÎ½Î¿ Î’Î®Î¼Î±
Î”ÎµÎ¯Ï„Îµ **06_PWM_Fade** Î³Î¹Î± Î±Î½Î±Î»Î¿Î³Î¹ÎºÏŒ Î­Î»ÎµÎ³Ï‡Î¿ Ï†Ï‰Ï„ÎµÎ¹Î½ÏŒÏ„Î·Ï„Î±Ï‚ Î¼Îµ PWM.
