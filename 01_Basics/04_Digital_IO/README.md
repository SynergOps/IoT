# 04_Digital_IO - Κουμπί & LED

## Περιγραφή
Αυτός ο φάκελος περιέχει παραδείγματα για την ανάγνωση ψηφιακών εισόδων (κουμπιά) και τον έλεγχο εξόδων (LED).

### Αρχεία Κώδικα
1.  **`button_led.ino`**: Απλή λογική "Momentary". Το LED ανάβει **μόνο** όσο κρατάμε πατημένο το κουμπί.
2.  **`button_toggle.ino`**: Λογική "Toggle" (Διακόπτης). Το κουμπί λειτουργεί σαν διακόπτης on/off. Κάθε πάτημα αλλάζει την κατάσταση του LED. Εισάγει την έννοια της **Μνήμης (State)**.

## Μαθησιακοί Στόχοι
- Κατανόηση digital input με `digitalRead()`
- Χρήση `INPUT_PULLUP` (εσωτερική αντίσταση pull-up)
- Λογική αντιστροφής (πατημένο = LOW)
- Συνδυασμός input και output
- **Κατανόηση if/else δομής ελέγχου**

## Σχεδιάγραμμα Κυκλώματος

```
           ┌─────────────────┐
           │   Arduino Uno   │
           │                 │
  ┌────────┤ D2(INPUT_PULLUP)│
  │        │                 │
  │        │  D13 (Built-in) ├──► LED εσωτερικό
  │        │                 │
  │    ┌───┤ GND             │
  │    │   └─────────────────┘
  │    │
  └─┬──┘      Κουμπί (Push Button)
    └─────     Πατήστε για σύνδεση D2 με GND
```

## Υλικά που Χρειάζονται
- 1× Arduino Uno
- 1× Κουμπί (Push Button / Tactile Switch)
- 2× Καλώδια jumper (αρσενικό-αρσενικό)
- 1× Breadboard

## Οδηγίες Σύνδεσης

### Βήμα προς Βήμα:
1. **Καλώδιο 1**: Συνδέστε ένα άκρο του κουμπιού στο **D2**
2. **Καλώδιο 2**: Συνδέστε το άλλο άκρο του κουμπιού στο **GND**
3. Δεν χρειάζεται εξωτερική αντίσταση (χρησιμοποιούμε `INPUT_PULLUP`)

### Πώς Λειτουργεί το INPUT_PULLUP:
- Όταν το κουμπί **δεν πατιέται**: D2 = HIGH (τραβιέται στα 5V εσωτερικά)
- Όταν το κουμπί **πατιέται**: D2 = LOW (συνδέεται με GND)

## Προχωρημένες Έννοιες (για το button_toggle.ino)

### 1. Μνήμη (State)
Στο `button_led.ino`, το LED ακολουθεί απλά το κουμπί. Στο `button_toggle.ino`, το Arduino πρέπει να "θυμάται" αν το LED ήταν αναμμένο ή σβηστό για να το αλλάξει. Αυτό γίνεται με μια μεταβλητή `ledState`.

### 2. Ανίχνευση Ακμής (Edge Detection)
Δεν μας νοιάζει αν το κουμπί *είναι* πατημένο, αλλά η στιγμή που *πατιέται* (η μετάβαση από HIGH σε LOW).

### 3. Αποθορυβοποίηση (Debounce)
Τα μηχανικά κουμπιά δεν κάνουν τέλεια επαφή αμέσως. Μπορεί να ανοιγοκλείσουν πολλές φορές σε λίγα milliseconds. Το Debounce είναι η τεχνική (software ή hardware) για να αγνοήσουμε αυτές τις ψεύτικες αλλαγές.
Σε αυτό το παράδειγμα χρησιμοποιούμε μια απλή καθυστέρηση `delay(50)` για να φιλτράρουμε τον θόρυβο, καθώς δεν έχουμε μάθει ακόμα την `millis()`.


## Πώς να το Τρέξετε

1. Ανοίξτε το `button_led.ino` στο Arduino IDE
2. Ανεβάστε στο Arduino
3. Πατήστε και κρατήστε το κουμπί → το LED ανάβει
4. Αφήστε το κουμπί → το LED σβήνει

## Επεξήγηση Κώδικα

Εστιάζουμε στη λογική ελέγχου μέσα στο `loop()`:

```cpp
// Διάβασε την κατάσταση του κουμπιού (HIGH ή LOW)
int buttonState = digitalRead(BTN);

// Έλεγχος: Είναι το κουμπί πατημένο;
if (buttonState == LOW) {
  // ✅ ΝΑΙ - Κουμπί ΠΑΤΗΜΕΝΟ (GND) → Άναψε το LED
  digitalWrite(LED_BUILTIN, HIGH);
} else {
  // ❌ ΟΧΙ - Κουμπί ΑΦΗΜΕΝΟ (5V) → Σβήσε το LED
  digitalWrite(LED_BUILTIN, LOW);
}
```

**Βασικές Έννοιες:**
- `INPUT_PULLUP`: Ενεργοποιεί εσωτερική αντίσταση ~20kΩ (στο `setup()`)
- `digitalRead(BTN)`: Διαβάζει την τάση στο pin
- **`if/else`**: Δομή απόφασης - "Αν το κουμπί είναι πατημένο, κάνε αυτό, αλλιώς κάνε εκείνο"

## Troubleshooting

| Πρόβλημα | Λύση |
|----------|------|
| LED δεν ανάβει ποτέ | Ελέγξτε σύνδεση κουμπιού, επαληθεύστε D2 & GND |
| LED πάντα αναμμένο | Κουμπί μπορεί να είναι βραχυκυκλωμένο ή ελαττωματικό |
| Ασταθής συμπεριφορά | Προσθέστε debouncing (δείτε παρακάτω) |

---

## Ροή Εκτέλεσης (Control Flow)

### Διάγραμμα Ροής (Flowchart)

```
┌────────────────────────┐
│   Έναρξη Loop()        │
└───────────┬────────────┘
            │
            ▼
┌────────────────────────────────────┐
│ buttonState = digitalRead(BTN)     │
│ (Διάβασε την κατάσταση του κουμπιού)
└───────────┬────────────────────────┘
            │
            ▼
     ┌──────────────────┐
     │ if (buttonState  │
     │    == LOW) ?     │
     └──┬─────────┬─────┘
    YES│         │NO
       ▼         ▼
  ┌────────┐ ┌──────────┐
  │HIGH=ON │ │ LOW=OFF  │
  └────┬───┘ └──────┬───┘
       │            │
       └────┬───────┘
            ▼
   ┌─────────────────┐
   │ Επόμενο Loop    │
   │ (επανάληψη)     │
   └─────────────────┘
```

### Πίνακας Αποφάσεων

| Κατάσταση | `buttonState` | Συνθήκη `== LOW` | Αποτέλεσμα | LED |
|-----------|---------------|-----------------|-----------|-----|
| Κουμπί ΑΦΗΜΕΝΟ | HIGH | FALSE ❌ | else block | OFF 🔴 |
| Κουμπί ΠΑΤΗΜΕΝΟ | LOW | TRUE ✅ | if block | ON 🟢 |

### Σεναριακή Εκτέλεση

```
⏱️ Χρονική Στιγμή 1: Κουμπί ΑΦΗΜΕΝΟ
├─ buttonState = digitalRead(2) → HIGH
├─ if (HIGH == LOW) → FALSE ❌
├─ else block εκτελείται
└─ LED = OFF 🔴

⏱️ Χρονική Στιγμή 2: ΠΑΤΑΜΕ το κουμπί
├─ buttonState = digitalRead(2) → LOW
├─ if (LOW == LOW) → TRUE ✅
├─ if block εκτελείται
└─ LED = ON 🟢

⏱️ Χρονική Στιγμή 3: ΞΑΝΑ ΑΦΗΜΕΝΟ
├─ buttonState = digitalRead(2) → HIGH
├─ if (HIGH == LOW) → FALSE ❌
├─ else block εκτελείται
└─ LED = OFF 🔴

⏱️ Χρονική Στιγμή 4: Επανάληψη...
```

---

## Κατανόηση if/else

### Γενική Σύνταξη

```cpp
if (condition) {
  // Κώδικας που εκτελείται ΑΝ η συνθήκη είναι TRUE
  // (αν η συνθήκη ισχύει)
} else {
  // Κώδικας που εκτελείται ΑΝ η συνθήκη είναι FALSE
  // (αν η συνθήκη δεν ισχύει)
}
```

### Παραδείγματα Συνθηκών

```cpp
// Σύγκρισης (Comparison)
if (age > 18) { }           // Μεγαλύτερο από
if (temperature < 0) { }    // Μικρότερο από
if (value == 5) { }         // Ίσο με
if (pin != HIGH) { }        // Όχι ίσο με

// Λογικές (Logical)
if (btn == LOW && sensor > 500) { }   // ΚΑΙ (AND)
if (btn == LOW || sensor > 500) { }   // Ή (OR)
if (!pressed) { }                      // ΟΧΙ (NOT)
```

### Παράδειγμα: Θερμοκρασία

```cpp
int temp = analogRead(A0);

if (temp > 30) {
  Serial.println("Πολύ ζεστά!");
  digitalWrite(LED_RED, HIGH);
} else {
  Serial.println("Κανονική θερμοκρασία.");
  digitalWrite(LED_RED, LOW);
}
```

---

## Πειραματισμός

1. **Αντιστροφή Λογικής**: Αλλάξτε την συνθήκη:
   ```cpp
   if (buttonState == HIGH) {  // Αναποδογυρισμένη λογική
     digitalWrite(LED_BUILTIN, HIGH);
   } else {
     digitalWrite(LED_BUILTIN, LOW);
   }
   ```

2. **Πολλαπλά Κουμπιά**: Προσθέστε δεύτερο κουμπί και LED:
   ```cpp
   const int BTN2 = 3;
   
   void setup() {
     pinMode(BTN, INPUT_PULLUP);
     pinMode(BTN2, INPUT_PULLUP);
     pinMode(LED_BUILTIN, OUTPUT);
     pinMode(12, OUTPUT);
   }
   
   void loop() {
     if (digitalRead(BTN) == LOW) {
       digitalWrite(LED_BUILTIN, HIGH);
     } else {
       digitalWrite(LED_BUILTIN, LOW);
     }
     
     if (digitalRead(BTN2) == LOW) {
       digitalWrite(12, HIGH);
     } else {
       digitalWrite(12, LOW);
     }
   }
   ```

3. **Debouncing**: Προσθέστε μικρή καθυστέρηση για σταθερότερες αναγνώσεις:
   ```cpp
   void loop() {
     if (digitalRead(BTN) == LOW) {
       delay(50);  // Debounce - περίμενε 50ms
       if (digitalRead(BTN) == LOW) {
         // Κουμπί όντως πατημένο
         digitalWrite(LED_BUILTIN, HIGH);
       }
     } else {
       digitalWrite(LED_BUILTIN, LOW);
     }
   }
   ```

4. **Σύνθετες Συνθήκες**: Χρησιμοποιήστε AND/OR:
   ```cpp
   if (digitalRead(BTN) == LOW && analogRead(A0) > 500) {
     // Και κουμπί πατημένο ΚΑΙ φως μεγάλο
     digitalWrite(LED_BUILTIN, HIGH);
   }
   ```

## Επόμενο Βήμα
Μάθετε **05_Millis_Timing** για μη-αποκλειστικό χρονισμό χωρίς `delay()`.
